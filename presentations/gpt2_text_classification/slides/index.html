
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="An example slide deck created using Marpi">
      
      
      
      
        <link rel="canonical" href="https://github.com/gmihaila/gmihaila.github.io/presentations/gpt2_text_classification/slides/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Markdow presentatioin - George Mihaila</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
      <link rel="manifest" href="../../../manifest.webmanifest" crossorigin="use-credentials">
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#text-classification-using-gpt-2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="George Mihaila" class="md-header__button md-logo" aria-label="George Mihaila" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.75 8a.75.75 0 0 0-.75.75v6.5c0 .414.336.75.75.75h6.5a.75.75 0 0 0 .75-.75v-6.5a.75.75 0 0 0-.75-.75h-6.5zm.75 6.5v-5h5v5h-5z"/><path fill-rule="evenodd" d="M15.25 1a.75.75 0 0 1 .75.75V4h2.25c.966 0 1.75.784 1.75 1.75V8h2.25a.75.75 0 0 1 0 1.5H20v5h2.25a.75.75 0 0 1 0 1.5H20v2.25A1.75 1.75 0 0 1 18.25 20H16v2.25a.75.75 0 0 1-1.5 0V20h-5v2.25a.75.75 0 0 1-1.5 0V20H5.75A1.75 1.75 0 0 1 4 18.25V16H1.75a.75.75 0 0 1 0-1.5H4v-5H1.75a.75.75 0 0 1 0-1.5H4V5.75C4 4.784 4.784 4 5.75 4H8V1.75a.75.75 0 0 1 1.5 0V4h5V1.75a.75.75 0 0 1 .75-.75zm3 17.5a.25.25 0 0 0 .25-.25V5.75a.25.25 0 0 0-.25-.25H5.75a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            George Mihaila
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Markdow presentatioin
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/gmihaila/machine_learning_things/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Machine Learning Things
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="George Mihaila" class="md-nav__button md-logo" aria-label="George Mihaila" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.75 8a.75.75 0 0 0-.75.75v6.5c0 .414.336.75.75.75h6.5a.75.75 0 0 0 .75-.75v-6.5a.75.75 0 0 0-.75-.75h-6.5zm.75 6.5v-5h5v5h-5z"/><path fill-rule="evenodd" d="M15.25 1a.75.75 0 0 1 .75.75V4h2.25c.966 0 1.75.784 1.75 1.75V8h2.25a.75.75 0 0 1 0 1.5H20v5h2.25a.75.75 0 0 1 0 1.5H20v2.25A1.75 1.75 0 0 1 18.25 20H16v2.25a.75.75 0 0 1-1.5 0V20h-5v2.25a.75.75 0 0 1-1.5 0V20H5.75A1.75 1.75 0 0 1 4 18.25V16H1.75a.75.75 0 0 1 0-1.5H4v-5H1.75a.75.75 0 0 1 0-1.5H4V5.75C4 4.784 4.784 4 5.75 4H8V1.75a.75.75 0 0 1 1.5 0V4h5V1.75a.75.75 0 0 1 .75-.75zm3 17.5a.25.25 0 0 0 .25-.25V5.75a.25.25 0 0 0-.25-.25H5.75a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5z"/></svg>

    </a>
    George Mihaila
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/gmihaila/machine_learning_things/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Machine Learning Things
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../activities/activities/" class="md-nav__link">
        Activities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../useful/useful/" class="md-nav__link">
        Useful Code
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Tutorial Notebooks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorial Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorial Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial_notebooks/bert_inner_workings/" class="md-nav__link">
        Bert Inner Workings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial_notebooks/pytorchtext_bucketiterator/" class="md-nav__link">
        PyTorchText BucketIterator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial_notebooks/pretrain_transformers_pytorch/" class="md-nav__link">
        Pretrain Transformers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial_notebooks/finetune_transformers_pytorch/" class="md-nav__link">
        Finetune Transformers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial_notebooks/gpt2_finetune_classification/" class="md-nav__link">
        GPT2 Finetune Classification
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../resume/resume/" class="md-nav__link">
        Resume
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gmihaila/machine_learning_things/tree/master/docs/src/markdown/presentations/gpt2_text_classification/slides.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <style>
img[alt~="center"] {
  display: block;
  margin: 0 auto;
}
</style>

<h1 id="text-classification-using-gpt-2"> Text Classification using GPT-2<a class="headerlink" href="#text-classification-using-gpt-2" title="Permanent link"></a></h1>
<p><br/><br/></p>
<p><strong>George Mihaila</strong></p>
<p><em>PhD Candidate Computer Science</em>
<em>University of North Texas</em></p>
<p><br/></p>
<hr />
<h1 id="disclaimer">Disclaimer<a class="headerlink" href="#disclaimer" title="Permanent link"></a></h1>
<ul>
<li>This is not your average tutorial on GPT-2! I will not focus on the original purpose of GPT-2 - text generation.</li>
<li>In this tutorial we'll use GPT-2 in a less conventional way - for text classification.</li>
</ul>
<hr />
<h1 id="agenda">Agenda<a class="headerlink" href="#agenda" title="Permanent link"></a></h1>
<ul>
<li>Intro</li>
<li>Understanding Natural Language Processing</li>
<li>Word embeddings</li>
<li>Text Classification</li>
<li>The Transformer</li>
<li>GPT-2</li>
<li>Architecture</li>
<li>Inner Workings</li>
<li>Prediction</li>
<li>Classification</li>
<li>Coding Session</li>
<li>Conclusions</li>
</ul>
<p><br></p>
<hr />
<h1 id="intro">Intro<a class="headerlink" href="#intro" title="Permanent link"></a></h1>
<h2 id="wikipedia">Wikipedia<a class="headerlink" href="#wikipedia" title="Permanent link"></a></h2>
<p><strong>Natural language processing (NLP)</strong> is a subfield of linguistics, computer science, and artificial intelligence <strong>concerned with the interactions between computers and human language</strong> &hellip;</p>
<p>&hellip; The result is a computer capable of <strong>"understanding"</strong> the contents of documents, including the contextual nuances of the language within them.</p>
<hr />
<h1 id="understanding-natural-language-processing">Understanding Natural Language Processing<a class="headerlink" href="#understanding-natural-language-processing" title="Permanent link"></a></h1>
<hr />
<h1 id="understanding-natural-language-processing_1">Understanding Natural Language Processing<a class="headerlink" href="#understanding-natural-language-processing_1" title="Permanent link"></a></h1>
<div class="highlight"><pre><span></span><code><span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;I love cats! Cats are very funny.&quot;</span>
</code></pre></div>
<hr />
<h1 id="understanding-natural-language-processing_2">Understanding Natural Language Processing<a class="headerlink" href="#understanding-natural-language-processing_2" title="Permanent link"></a></h1>
<div class="highlight"><pre><span></span><code><span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;I love cats! Cats are very funny.&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">,</span> <span class="s1">&#39;funny&#39;</span><span class="p">]</span>
</code></pre></div>
<hr />
<h1 id="understanding-natural-language-processing_3">Understanding Natural Language Processing<a class="headerlink" href="#understanding-natural-language-processing_3" title="Permanent link"></a></h1>
<div class="highlight"><pre><span></span><code><span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;I love cats! Cats are very funny.&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">,</span> <span class="s1">&#39;funny&#39;</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">word_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</code></pre></div>
<hr />
<h1 id="understanding-natural-language-processing_4">Understanding Natural Language Processing<a class="headerlink" href="#understanding-natural-language-processing_4" title="Permanent link"></a></h1>
<div class="highlight"><pre><span></span><code><span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;I love cats! Cats are very funny.&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">,</span> <span class="s1">&#39;funny&#39;</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">word_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</code></pre></div>
<p>Encode text into numbers.</p>
<hr />
<h1 id="word-embeddings">Word embeddings<a class="headerlink" href="#word-embeddings" title="Permanent link"></a></h1>
<hr />
<p><img alt="bg vertical right fit:30% 60%" src="../word_ids.png" /></p>
<h1 id="word-embeddings_1">Word embeddings<a class="headerlink" href="#word-embeddings_1" title="Permanent link"></a></h1>
<ul>
<li>Use numbers to represent words:
  <div class="highlight"><pre><span></span><code><span class="s1">&#39;love&#39;</span> <span class="p">:</span> <span class="mi">1</span>
<span class="s1">&#39;cats&#39;</span> <span class="p">:</span> <span class="mi">2</span>
<span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="mi">4</span>
</code></pre></div></li>
</ul>
<hr />
<p><img alt="bg vertical right fit:30% 60%" src="../word_ids.png" />
<img alt="bg fit" src="../word_vectors.png" /></p>
<h1 id="word-embeddings_2">Word embeddings<a class="headerlink" href="#word-embeddings_2" title="Permanent link"></a></h1>
<ul>
<li>
<p>Use numbers to represent words:
  <div class="highlight"><pre><span></span><code><span class="s1">&#39;love&#39;</span> <span class="p">:</span> <span class="mi">1</span>
<span class="s1">&#39;cats&#39;</span> <span class="p">:</span> <span class="mi">2</span>
<span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="mi">4</span>
</code></pre></div></p>
</li>
<li>
<p>User vectors instead of numbers</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;love&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">3.10</span><span class="p">]</span>
<span class="s1">&#39;cats&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">3.40</span><span class="p">,</span> <span class="mf">3.20</span><span class="p">]</span>
<span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">1.88</span><span class="p">]</span>
</code></pre></div>
<hr />
<p><img alt="bg vertical right fit:30% 60%" src="../word_ids.png" />
<img alt="bg fit" src="../word_vectors.png" /></p>
<h1 id="word-embeddings_3">Word embeddings<a class="headerlink" href="#word-embeddings_3" title="Permanent link"></a></h1>
<ul>
<li>
<p>Use numbers to represent words:
  <div class="highlight"><pre><span></span><code><span class="s1">&#39;love&#39;</span> <span class="p">:</span> <span class="mi">1</span>
<span class="s1">&#39;cats&#39;</span> <span class="p">:</span> <span class="mi">2</span>
<span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="mi">4</span>
</code></pre></div></p>
</li>
<li>
<p>User vectors instead of numbers
  <div class="highlight"><pre><span></span><code><span class="s1">&#39;love&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">3.10</span><span class="p">]</span>
<span class="s1">&#39;cats&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">3.40</span><span class="p">,</span> <span class="mf">3.20</span><span class="p">]</span>
<span class="s1">&#39;funny&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">1.88</span><span class="p">]</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Word embeddings</strong> are a type of word <strong>representation</strong> that allows words with similar meaning to have a similar representation.</p>
</li>
</ul>
<hr />
<h1 id="text-classification">Text Classification<a class="headerlink" href="#text-classification" title="Permanent link"></a></h1>
<ul>
<li>Is the task of <strong>assigning</strong> a set of predefined categories to text data.</li>
<li>Text classifiers can be used to <strong>organize</strong>, <strong>structure</strong>, and <strong>categorize</strong> any kind of text: <em>documents, medical studies &hellip;</em></li>
<li>For example:</li>
<li><strong>new articles</strong> can be organized by <strong>topics</strong>;</li>
<li><strong>support tickets</strong> can be organized by <strong>urgency</strong>;</li>
<li><strong>movie reviews</strong> can be organized by <strong>sentiment</strong>;</li>
</ul>
<hr />
<h1 id="text-classification_1">Text Classification<a class="headerlink" href="#text-classification_1" title="Permanent link"></a></h1>
<h2 id="movie-reviews-sentiment-classification">Movie reviews sentiment classification<a class="headerlink" href="#movie-reviews-sentiment-classification" title="Permanent link"></a></h2>
<p><img alt="center" src="../text_classification.png" /></p>
<hr />
<h1 id="the-transformer">The Transformer<a class="headerlink" href="#the-transformer" title="Permanent link"></a></h1>
<ul>
<li>Is a <strong>deep neural network architecture</strong> for <strong>transforming one sequence into another one</strong> with the help of two parts (<strong>Encoder</strong> and <strong>Decoder</strong>).</li>
<li>Was first introduced by Google in 2017 in the paper <a href="https://arxiv.org/pdf/1706.03762.pdf">Attention Is All You Need</a>.</li>
<li>Is based solely on attention mechanisms.</li>
<li>It brought <strong><em>"the biggest leap forward in the past five years, and one of the biggest leaps forward in the history of Search."</em></strong> for Google.</li>
</ul>
<hr />
<h1 id="the-transformer_1">The Transformer<a class="headerlink" href="#the-transformer_1" title="Permanent link"></a></h1>
<ul>
<li>Is a <strong>deep neural network architecture</strong> for <strong>transforming one sequence into another one</strong> with the help of two parts (<strong>Encoder</strong> and <strong>Decoder</strong>).</li>
<li>It can <strong><em>transform</em></strong> an article to a summary or translate english to another language, etc.</li>
</ul>
<p><img alt="bg vertical right fit" src="../transformers.png" /></p>
<hr />
<h1 id="the-transformer_2">The Transformer<a class="headerlink" href="#the-transformer_2" title="Permanent link"></a></h1>
<ul>
<li>Is based solely on attention mechanisms.</li>
</ul>
<p><img alt="bg vertical right fit" src="../self_attention.png" /></p>
<ul>
<li><strong>Disclaimer:</strong></li>
<li>I will not cover attention since this is not the intent of this tutorial.</li>
<li><a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a> by <a href="http://jalammar.github.io">Jay Alammar</a> is great resource!</li>
</ul>
<hr />
<h1 id="gpt-2">GPT-2<a class="headerlink" href="#gpt-2" title="Permanent link"></a></h1>
<p><img alt="bg vertical right fit" src="../gpt2.png" /></p>
<hr />
<h1 id="gpt-2_1">GPT-2<a class="headerlink" href="#gpt-2_1" title="Permanent link"></a></h1>
<p><img alt="bg vertical right fit" src="../gpt2.png" /></p>
<h2 id="wikipedia_1">Wikipedia<a class="headerlink" href="#wikipedia_1" title="Permanent link"></a></h2>
<p><strong>Generative Pre-trained Transformer 2 (GPT-2)</strong> is an open-source artificial intelligence created by OpenAI in February 2019. GPT-2 <strong>translates text, answers questions, summarizes passages, and generates text output</strong> on a level that, while sometimes indistinguishable from that of humans, can become repetitive or nonsensical when generating long passages.</p>
<hr />
<h1 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link"></a></h1>
<hr />
<h1 id="architecture_1">Architecture<a class="headerlink" href="#architecture_1" title="Permanent link"></a></h1>
<ul>
<li>We only have the decoder side of Transformer:</li>
</ul>
<p><img alt="" src="../transformers.png" />
<img alt="bg vertical right fit 60% 60%" src="../gpt2_decoder.png" /></p>
<hr />
<h1 id="architecture_2">Architecture<a class="headerlink" href="#architecture_2" title="Permanent link"></a></h1>
<ul>
<li>There are multiple variations of GPT-2 depending on the number of decoder blocks:</li>
</ul>
<p><img alt="center" src="../gpt2-sizes-hyperparameters-3.png" /></p>
<hr />
<h1 id="inner-workings">Inner Workings<a class="headerlink" href="#inner-workings" title="Permanent link"></a></h1>
<ul>
<li><a href="">Detailed diagram</a></li>
</ul>
<hr />
<h1 id="prediction">Prediction<a class="headerlink" href="#prediction" title="Permanent link"></a></h1>
<h2 id="wikipedia_2">Wikipedia<a class="headerlink" href="#wikipedia_2" title="Permanent link"></a></h2>
<p>GPT-2 <strong>translates text, answers questions, summarizes passages, and generates text output</strong>&hellip;</p>
<p>Let's see how it make predictions.</p>
<hr />
<h1 id="prediction_1">Prediction<a class="headerlink" href="#prediction_1" title="Permanent link"></a></h1>
<ul>
<li>We pass the text <strong><em>"a robot must"</em></strong> to GPT-2.</li>
<li>GPT-2 will output word embeddings for each of the words.</li>
<li>The last word embedding is used to predict the next word <strong><em>"obey"</em></strong>.</li>
</ul>
<p><img alt="bg horizontal right fit" src="../first_prediction.png" /></p>
<hr />
<h1 id="prediction_2">Prediction<a class="headerlink" href="#prediction_2" title="Permanent link"></a></h1>
<ul>
<li>Our new text <strong><em>"a robot must obey"</em></strong> is fed to GPT-2.</li>
<li>Same process is repeated to predict the next word <strong><em>"orders"</em></strong>.</li>
</ul>
<p><img alt="bg horizontal right fit" src="../second_prediciton.png" /></p>
<hr />
<h1 id="prediction_3">Prediction<a class="headerlink" href="#prediction_3" title="Permanent link"></a></h1>
<ul>
<li>This is how GPT-2 is able to <strong>translates text, answers questions, summarizes passages, and generates text output</strong>.</li>
<li><strong>How can we use it for simple text classification?</strong></li>
</ul>
<hr />
<h1 id="classification">Classification<a class="headerlink" href="#classification" title="Permanent link"></a></h1>
<ul>
<li>Now we'll use GPT-2 to perform text classification.</li>
</ul>
<hr />
<h1 id="classification_1">Classification<a class="headerlink" href="#classification_1" title="Permanent link"></a></h1>
<ul>
<li>
<p>Now we'll use GPT-2 to perform text classification.</p>
</li>
<li>
<p>We'll classify a movie review as being either positive or negative sentiment.</p>
</li>
</ul>
<p><img alt="center" src="../gpt2_text_classification.png" /></p>
<hr />
<h1 id="classification_2">Classification<a class="headerlink" href="#classification_2" title="Permanent link"></a></h1>
<ul>
<li>Let's look at a positive movie review:</li>
</ul>
<p><img alt="center" src="../predict_positive.png" /></p>
<hr />
<h1 id="classification_3">Classification<a class="headerlink" href="#classification_3" title="Permanent link"></a></h1>
<ul>
<li>Now let's look at a negative movie review:</li>
</ul>
<p><img alt="center" src="../predict_negative.png" /></p>
<hr />
<h1 id="coding-session">Coding Session<a class="headerlink" href="#coding-session" title="Permanent link"></a></h1>
<h2 id="-gpt-2-for-text-classification-using-hugging-face--transformers">🎱 GPT-2 For Text Classification using Hugging Face 🤗 Transformers<a class="headerlink" href="#-gpt-2-for-text-classification-using-hugging-face--transformers" title="Permanent link"></a></h2>
<h3 id="complete-tutorial-on-how-to-use-gpt-2-for-text-classification">Complete tutorial on how to use GPT-2 for text classification.<a class="headerlink" href="#complete-tutorial-on-how-to-use-gpt-2-for-text-classification" title="Permanent link"></a></h3>
<p><a href="https://colab.research.google.com/github/gmihaila/ml_things/blob/master/notebooks/pytorch/gpt2_finetune_classification.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a> <a href="https://github.com/gmihaila/ml_things/blob/master/notebooks/pytorch/gpt2_finetune_classification.ipynb"><img alt="Generic badge" src="https://img.shields.io/badge/GitHub-Source-greensvg" /></a> <a href="https://www.dropbox.com/s/6t6kvlewoabwxqw/gpt2_finetune_classification.ipynb?dl=1"><img alt="Generic badge" src="https://img.shields.io/badge/Download-Notebook-red.svg" /></a> <a href="https://gmihaila.medium.com/gpt2-for-text-classification-using-hugging-face-transformers-574555451832"><img alt="Generic badge" src="https://img.shields.io/badge/Article-Medium-black.svg" /></a> <a href="https://opensource.org/licenses/Apache-2.0"><img alt="License" src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" /></a></p>
<ul>
<li>
<p><strong>Disclaimer:</strong> <em>The format of this tutorial notebook is very similar to my other tutorial notebooks. This is done intentionally in order to keep readers familiar with my format.</em></p>
</li>
<li>
<p>This notebook is used to fine-tune GPT-2 model for text classification using <a href="https://huggingface.co/transformers/">Huggingface</a> <a href="https://github.com/huggingface/transformers">transformers</a> library on a custom dataset.</p>
</li>
</ul>
<hr />
<h1 id="conclusions">Conclusions<a class="headerlink" href="#conclusions" title="Permanent link"></a></h1>
<ul>
<li>I showed that GPT-2 <strong>can</strong> be used for text classification.</li>
<li>Depending on your data and classification task GPT-2 could outperform other transformers models.</li>
<li>It's always good to have options.</li>
</ul>
<hr />
<h1 id="contact-">Contact 🎣<a class="headerlink" href="#contact-" title="Permanent link"></a></h1>
<p>Let's stay in touch!</p>
<p>🦊 GitHub: <a href="https://github.com/gmihaila">gmihaila</a></p>
<p>🌐 Website: <a href="https://gmihaila.github.io/">gmihaila.github.io</a></p>
<p>👔 LinkedIn: <a href="https://www.linkedin.com/in/mihailageorge/">mihailageorge</a></p>
<p>📓 Medium: <a href="https://gmihaila.medium.com">@gmihaila</a></p>
<p>📬 Email: <a href="mailto:georgemihaila@my.unt.edu.com?subject=GitHub%20Website">georgemihaila@my.unt.edu.com</a></p>
<p>👤 Schedule meeting: <a href="https://calendly.com/georgemihaila">calendly.com/georgemihaila</a></p>
<hr />
<h1 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link"></a></h1>
<ul>
<li><a href="https://monkeylearn.com/text-classification/">Text Classification</a></li>
<li><a href="https://medium.com/inside-machine-learning/what-is-a-transformer-d07dd1fbec04">What is a transformer</a></li>
<li><a href="https://whatsnewinpublishing.com/google-has-made-one-of-the-biggest-leaps-forward-in-the-history-of-search-what-it-means-for-publishers/">Google's Search Engine biggest leap</a></li>
<li><a href="https://www.analyticsvidhya.com/blog/2019/06/understanding-transformers-nlp-state-of-the-art-models/">Understand transformers</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2015 - 2020 <a href="https://github.com/gmihaila"  target="_blank" rel="noopener">George Mihaila</a>

          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/gmihaila" target="_blank" rel="noopener" title="gmihaila" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://gmihaila.medium.com/" target="_blank" rel="noopener" title="gmihaila" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 32v448h448V32H0zm372.2 106.1l-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"/></svg>
      </a>
    
      
      
      <a href="https://www.linkedin.com/in/mihailageorge" target="_blank" rel="noopener" title="mihailageorge" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["instant", "header.autohide", "search.highlight", "search.share", "search.suggest", "navigation.top", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>